const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/pdf-BGng-i1c.js","assets/supabase-D999gSRu.js","assets/react-9ItUixmA.js"])))=>i.map(i=>d[i]);
import{_ as f}from"./supabase-D999gSRu.js";import{j as e}from"./radix-pxeQr2vL.js";import{k as I,b as i}from"./react-9ItUixmA.js";import{I as r,s as b}from"./index-DDd0kLwX.js";import"./shadcn_misc-DPVfRoQl.js";const o=[{key:"pendiente",label:"Pendiente"},{key:"procesando",label:"Procesando"},{key:"enviado",label:"Enviado"},{key:"entregado",label:"Entregado"}],M=()=>{const{id:l}=I(),[a,y]=i.useState(null),[c,N]=i.useState(null),[v,h]=i.useState(!0),m=i.useRef(null),_=async()=>{if(!m.current||!a)return;const[s,t]=await Promise.all([f(()=>import("./pdf-BGng-i1c.js").then(x=>x.h),__vite__mapDeps([0,1,2])),f(()=>import("./pdf-BGng-i1c.js").then(x=>x.j),__vite__mapDeps([0,1,2]))]),S=s.default||s,k=t.jsPDF||t.default,n=await S(m.current,{scale:2,backgroundColor:"#ffffff"}),E=n.toDataURL("image/png"),d=new k("p","mm","a4"),p=d.internal.pageSize.getWidth(),D=d.internal.pageSize.getHeight(),u=Math.min(p/n.width,D/n.height),j=n.width*u,C=n.height*u,L=(p-j)/2;d.addImage(E,"PNG",L,10,j,C),d.save(`pedido-${String(a.id).slice(0,8)}.pdf`)},w=async()=>{h(!0);const[{data:s},{data:t}]=await Promise.all([b.from("orders").select("id, invoice_number, total, estado, created_at, order_items(id,producto_nombre,cantidad,precio_unitario,subtotal,producto_imagen_url)").eq("id",l).maybeSingle(),b.from("order_shipping").select("*").eq("order_id",l).maybeSingle()]);y(s),N(t),h(!1)};if(i.useEffect(()=>{w()},[l]),v)return e.jsx("div",{className:"container py-8",children:e.jsx("div",{className:"flex items-center justify-center",children:e.jsx(r,{category:"Estados y Feedback",name:"HugeiconsReload",className:"w-8 h-8 animate-spin"})})});if(!a)return e.jsx("div",{className:"container py-8",children:"Pedido no encontrado"});const g=o.findIndex(s=>s.key===a.estado),P=s=>{switch(s){case"entregado":return"badge-success";case"enviado":return"badge-primary";case"procesando":return"badge-warning";default:return"badge-secondary"}};return e.jsxs("div",{className:"container py-8",ref:m,children:[e.jsxs("div",{className:"mb-6 flex items-start justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"heading-lg flex items-center gap-3",children:[e.jsx(r,{category:"Pedidos",name:"MaterialSymbolsOrdersOutlineRounded",className:"w-8 h-8"}),"Pedido ",a.invoice_number||"#"+String(a.id).slice(0,8)]}),e.jsxs("p",{className:"text-gray-600 flex items-center gap-2",children:[e.jsx(r,{category:"Estados y Feedback",name:"IconoirWarningSquare",className:"w-4 h-4"}),"Creado: ",new Date(a.created_at).toLocaleString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`badge capitalize ${P(a.estado)}`,children:a.estado}),e.jsxs("button",{className:"btn btn-secondary flex items-center gap-2",onClick:_,children:[e.jsx(r,{category:"Carrito y checkout",name:"TablerDownload",className:"w-4 h-4"}),"Descargar PDF"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2 card card-hover",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(r,{category:"Pedidos",name:"GgLoadbar",className:"w-5 h-5"}),"Estado del pedido"]}),e.jsx("div",{className:"flex items-center justify-between",children:o.map((s,t)=>e.jsxs("div",{className:"flex-1 flex items-center",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-white ring-2 ring-white shadow ${t<=g?"bg-green-500":"bg-gray-300"}`,children:t+1}),t<o.length-1&&e.jsx("div",{className:`h-1 flex-1 mx-1 rounded ${t<g?"bg-green-500":"bg-gray-300"}`})]},s.key))}),e.jsx("div",{className:"mt-2 flex items-center justify-between text-xs text-gray-600",children:o.map(s=>e.jsx("span",{children:s.label},s.key))})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("h3",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(r,{category:"Catálogo y producto",name:"BxsPackage",className:"w-5 h-5"}),"Productos"]}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"text-left text-gray-500 border-b",children:[e.jsx("th",{className:"py-2 pr-4",children:"Producto"}),e.jsx("th",{className:"py-2 pr-4",children:"Cantidad"}),e.jsx("th",{className:"py-2 pr-4",children:"Unitario"}),e.jsx("th",{className:"py-2 pr-4",children:"Subtotal"})]})}),e.jsx("tbody",{children:(a.order_items||[]).map(s=>e.jsxs("tr",{className:"border-b",children:[e.jsx("td",{className:"py-3 pr-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.producto_imagen_url&&e.jsx("img",{src:s.producto_imagen_url,alt:s.producto_nombre,className:"w-10 h-10 object-cover rounded"}),e.jsx("span",{className:"font-medium",children:s.producto_nombre})]})}),e.jsx("td",{className:"py-3 pr-4",children:s.cantidad}),e.jsxs("td",{className:"py-3 pr-4",children:["$",Number(s.precio_unitario).toLocaleString()]}),e.jsxs("td",{className:"py-3 pr-4 font-semibold",children:["$",Number(s.subtotal).toLocaleString()]})]},s.id))})]})]})]})}),e.jsx("div",{className:"card card-hover h-max",children:e.jsxs("div",{className:"card-body space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-gray-600 flex items-center gap-2",children:[e.jsx(r,{category:"Carrito y checkout",name:"VaadinWallet",className:"w-4 h-4"}),"Total"]}),e.jsxs("span",{className:"text-2xl font-bold text-(--color-terracotta-suave)",children:["$",Number(a.total).toLocaleString()]})]}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("h3",{className:"font-semibold flex items-center gap-2",children:[e.jsx(r,{category:"Carrito y checkout",name:"HugeiconsMapsLocation01",className:"w-4 h-4"}),"Envío"]}),c?e.jsxs("div",{className:"text-sm text-gray-700",children:[e.jsx("div",{children:c.nombre}),e.jsx("div",{children:c.direccion}),e.jsx("div",{children:c.ciudad}),e.jsx("div",{children:c.telefono})]}):e.jsx("div",{className:"text-sm text-gray-500",children:"Sin información de envío"}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:"Impuestos incluidos donde aplique"})]})]})})]})]})};export{M as default};
