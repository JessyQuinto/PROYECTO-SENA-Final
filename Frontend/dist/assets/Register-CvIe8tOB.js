import{j as e}from"./radix-pxeQr2vL.js";import{i as B,b as n,L as R}from"./react-9ItUixmA.js";import{u as T,s as F,B as q}from"./index-DDd0kLwX.js";import{I as m}from"./input-s_SeVYy5.js";import{L as l}from"./label-BStnk5CR.js";import{C as w}from"./checkbox-Yuj4HFAq.js";import{o as A,s as b}from"./shadcn_misc-DPVfRoQl.js";import"./supabase-D999gSRu.js";const k={Chocó:["Quibdó","Istmina","Tadó","Condoto","Acandí","Bahía Solano","Nuquí","Riosucio","Unguía","Lloró"],Antioquia:["Medellín","Envigado","Bello","Itagüí","Rionegro"],Cundinamarca:["Soacha","Chía","Zipaquirá","Facatativá","Mosquera"],"Valle del Cauca":["Cali","Palmira","Yumbo","Tuluá","Buga"],"Bogotá D.C.":["Bogotá"]};function D(){return Object.keys(k)}function M(c){return c?k[c]??[]:[]}const z=A({email:b().email("Email inválido"),password:b().min(6,"La contraseña debe tener al menos 6 caracteres"),confirmPassword:b().min(6,"Confirma tu contraseña")}).refine(c=>c.password===c.confirmPassword,{message:"Las contraseñas no coinciden",path:["confirmPassword"]}),G=()=>{const{signUp:c}=T(),h=B(),[d,N]=n.useState("comprador"),[x,S]=n.useState(!1),[o,u]=n.useState({email:"",nombre:"",password:"",confirmPassword:""}),[r,p]=n.useState({telefono:"",ciudad:"",departamento:"",confirmInfo:!1}),E=D(),I=M(r.departamento),[s,f]=n.useState({}),[C,y]=n.useState(null),[L,g]=n.useState(!1),[H,O]=n.useState(120),P=async a=>{a.preventDefault(),f({}),y(null);const i=z.safeParse(o),t={};if(i.success||i.error?.errors.forEach(v=>{v.path[0]&&(t[v.path[0]]=v.message)}),o.nombre||(t.nombre="El nombre es obligatorio"),r.telefono||(t.telefono="El teléfono es obligatorio"),r.ciudad||(t.ciudad="La ciudad es obligatoria"),r.departamento||(t.departamento="El departamento es obligatorio"),r.confirmInfo||(t.confirmInfo="Debes confirmar que la información es verdadera"),x||(t.terms="Debes aceptar los términos y condiciones"),Object.keys(t).length>0){f(t);return}g(!0);const j=await c(o.email,o.password,d,{nombre:o.nombre,telefono:r.telefono,ciudad:r.ciudad,departamento:r.departamento,acceptedTerms:x});if(j.error){f({general:j.error}),window.toast?.error(j.error,{action:"register"}),g(!1);return}y("Registro exitoso. Revisa tu correo para confirmar."),g(!1),h("/verifica-tu-correo",{replace:!0,state:{email:o.email}})};return n.useEffect(()=>{const a=F?.auth.onAuthStateChange((i,t)=>{t?.user&&h("/login",{replace:!0})});return()=>{a?.data?.subscription?.unsubscribe?.()}},[h]),e.jsxs("div",{className:"min-h-[calc(100vh-120px)] grid place-items-center relative overflow-hidden",children:[e.jsx("div",{"aria-hidden":!0,className:"absolute inset-0 opacity-12",style:{backgroundImage:"linear-gradient(to right, rgba(0,0,0,0.04), rgba(0,0,0,0.00)), url('/assert/motif-de-fond-sans-couture-tribal-dessin-geometrique-noir-et-blanc-vecteur/v1045-03.jpg')",backgroundSize:"cover",backgroundPosition:"center"}}),e.jsx("div",{className:"container max-w-5xl relative z-10",children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-8 items-start",children:[e.jsx("div",{className:"hidden md:block md:col-span-1",children:e.jsx("div",{className:"card card-hover",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h1",{className:"text-2xl font-semibold mb-2 font-display",children:"Crea tu cuenta"}),e.jsx("p",{className:"opacity-80",children:"Únete como comprador o vendedor y forma parte de esta comunidad."})]})})}),e.jsx("div",{className:"card card-hover md:col-span-2",children:e.jsxs("div",{className:"card-body",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Registro"}),s.general&&e.jsx("div",{className:"mb-4 rounded-lg bg-red-50 text-red-700 px-3 py-2 text-sm",children:s.general}),C&&e.jsx("div",{className:"mb-4 rounded-lg bg-green-50 text-green-700 px-3 py-2 text-sm",children:C}),e.jsxs("form",{className:"space-y-6",onSubmit:P,children:[e.jsxs("div",{children:[e.jsx("label",{className:"form-label mb-2",children:"Elige tu tipo de cuenta"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx("div",{className:`select-card p-5 ${d==="comprador"?"selected":""}`,onClick:()=>N("comprador"),role:"button",tabIndex:0,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-md",children:e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Comprador"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Navega el catálogo, añade al carrito y compra artesanías."})]}),d==="comprador"&&e.jsx("span",{className:"badge badge-success",children:"Seleccionado"})]})}),e.jsx("div",{className:`select-card p-5 ${d==="vendedor"?"selected":""}`,onClick:()=>N("vendedor"),role:"button",tabIndex:0,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-gray-100 rounded-md",children:e.jsx("svg",{className:"w-6 h-6 text-gray-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V7a2 2 0 00-2-2h-2l-2-2H8L6 5H4a2 2 0 00-2 2v6m18 0a2 2 0 01-2 2H4a2 2 0 01-2-2m18 0v5a2 2 0 01-2 2H4a2 2 0 01-2-2v-5"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold mb-1",children:"Vendedor"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Publica productos, gestiona pedidos y ventas. Requiere aprobación."})]}),d==="vendedor"&&e.jsx("span",{className:"badge badge-success",children:"Seleccionado"})]})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"nombre",children:"Nombre"}),e.jsx(m,{id:"nombre",value:o.nombre,onChange:a=>u({...o,nombre:a.target.value}),placeholder:"Tu nombre completo"}),s.nombre&&e.jsx("span",{className:"error-text",children:s.nombre})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"email",children:"Email"}),e.jsx(m,{id:"email",value:o.email,onChange:a=>u({...o,email:a.target.value}),placeholder:"tu@email.com"}),s.email&&e.jsx("span",{className:"error-text",children:s.email})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"password",children:"Contraseña"}),e.jsx(m,{id:"password",type:"password",value:o.password,onChange:a=>u({...o,password:a.target.value}),placeholder:"••••••••"}),s.password&&e.jsx("span",{className:"error-text",children:s.password})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"confirm",children:"Confirmar contraseña"}),e.jsx(m,{id:"confirm",type:"password",value:o.confirmPassword,onChange:a=>u({...o,confirmPassword:a.target.value}),placeholder:"••••••••"}),s.confirmPassword&&e.jsx("span",{className:"error-text",children:s.confirmPassword})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"telefono",children:"Teléfono"}),e.jsx(m,{id:"telefono",value:r.telefono,onChange:a=>p({...r,telefono:a.target.value}),placeholder:"300 000 0000"}),s.telefono&&e.jsx("span",{className:"error-text",children:s.telefono})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"departamento",children:"Departamento"}),e.jsxs("select",{id:"departamento",className:"form-select",value:r.departamento,onChange:a=>{const i=a.target.value;p(t=>({...t,departamento:i,ciudad:""}))},children:[e.jsx("option",{value:"",children:"Selecciona un departamento"}),E.map(a=>e.jsx("option",{value:a,children:a},a))]}),s.departamento&&e.jsx("span",{className:"error-text",children:s.departamento})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(l,{htmlFor:"ciudad",children:"Ciudad"}),e.jsxs("select",{id:"ciudad",className:"form-select",value:r.ciudad,onChange:a=>p(i=>({...i,ciudad:a.target.value})),disabled:!r.departamento,children:[e.jsx("option",{value:"",children:"Selecciona una ciudad"}),I.map(a=>e.jsx("option",{value:a,children:a},a))]}),s.ciudad&&e.jsx("span",{className:"error-text",children:s.ciudad})]})]}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(w,{checked:r.confirmInfo,onCheckedChange:a=>p({...r,confirmInfo:!!a})}),"Confirmo que la información es verdadera"]}),s.confirmInfo&&e.jsx("span",{className:"error-text",children:s.confirmInfo}),e.jsxs("label",{className:"flex items-center gap-2 text-sm",children:[e.jsx(w,{checked:x,onCheckedChange:a=>S(!!a)}),"Acepto los ",e.jsx("a",{className:"text-(--color-terracotta-suave) hover:underline",href:"/terminos",target:"_blank",rel:"noreferrer",children:"términos y condiciones"})]}),s.terms&&e.jsx("span",{className:"error-text",children:s.terms}),e.jsx(q,{type:"submit",className:"w-full",disabled:L,children:"Crear cuenta"}),e.jsxs("div",{className:"text-sm text-center",children:["¿Ya tienes cuenta? ",e.jsx(R,{to:"/login",className:"text-(--color-terracotta-suave) hover:underline",children:"Inicia sesión"})]})]})]})})]})})]})};export{G as RegisterPage,G as default};
